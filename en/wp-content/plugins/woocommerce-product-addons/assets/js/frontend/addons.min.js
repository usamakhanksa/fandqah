! function(m, _) {
    const a = PaoValidation;

    function e(t) {
        return this instanceof e ? !!t.length && (this.$el = t, this.$addons = this.$el.find(".wc-pao-addon-field"), this.$addons.length ? (this.is_rtl = "rtl" === document.documentElement.dir, this.validation = new a(this), this.totals = new o(this), this.show_incomplete_subtotals = this.totals.showIncompleteSubtotals(), this.contains_required = this.containsRequired(), this.setupEvents(), this.validation.validate(), this.updateTotals(), m(".wc-pao-addon-image-swatch").tipTip({
            delay: 200
        }), void WC_PAO.initialized_forms.push(this)) : this.$addons = !1) : new e(t)
    }

    function o(t) {
        return this instanceof o ? !m.isEmptyObject(t) && (this.$form = t.$el, this.$addons = t.$addons, this.$variation_input = !!this.$form.hasClass("variations_form") && this.$form.find('input[name="variation_id"], input.variation_id'), this.is_variable = this.$variation_input && 0 < this.$variation_input.length, this.$totals = this.$form.find("#product-addons-total"), this.product_id = this.is_variable ? this.$variation_input.val() : this.$totals.data("product-id"), !!this.product_id) && (this.base_price = this.$totals.data("price"), this.raw_price = this.$totals.data("raw-price"), this.product_type = this.$totals.data("type"), this.qty = parseFloat(this.$form.find("input.qty").val()), this.addons_price_data = [], this.$subscription_plans = this.$form.find(".wcsatt-options-product"), this.has_subscription_plans = 0 < this.$subscription_plans.length, this.is_rtl = t.is_rtl, this.total = 0, this.total_raw = 0, void(this.show_subtotal_panel = !0)) : new o(t)
    }(WC_PAO = _.WC_PAO || {}).initialized_forms = [], WC_PAO.Helper = {
        escapeHtml: function(t) {
            return document.createElement("div").appendChild(document.createTextNode(t)).parentNode.innerHTML
        },
        isGroupedSubsSelected: function() {
            var t = m(".product-type-grouped"),
                a = !1;
            return t.length && t.find(".group_table tr.product").each(function() {
                if (0 < m(this).find(".input-text.qty").val() && m(this).find(".entry-summary .subscription-details").length) return !(a = !0)
            }), a
        },
        addMinutes: function(t, a) {
            return new Date(t.getTime() + 6e4 * a)
        },
        isGroupedMixedProductType: function() {
            var t = m(".product-type-grouped"),
                a = 0,
                e = 0;
            return !!(t.length && (t.find(".group_table tr.product").each(function() {
                0 < m(this).find(".input-text.qty").val() && (m(this).find(".entry-summary .subscription-details").length ? a++ : e++)
            }), 0 < a) && 0 < e)
        },
        delay: function(t, a) {
            clearTimeout(0), setTimeout(t, a)
        }
    }, WC_PAO.Form = (e.prototype.setupEvents = function() {
        var i, s = this;
        s.$el.find('button[type="submit"]').on("click", function() {
            var t;
            return !!s.validation.validate(!0) || (0 < (t = s.$el.find(".wc-pao-validation-notice")).length && 0 < (t = s.$el.find(t[0].closest(".wc-pao-addon-container"))).length && !s.is_in_viewport(t) && t[0].scrollIntoView(), !1)
        }), s.$el.on("blur change", ".wc-pao-addon input, .wc-pao-addon textarea, .wc-pao-addon select, .wc-pao-addon-custom-text", function() {
            s.validation.validateAddon(m(this), !0), s.updateTotals()
        }), s.$el.on("keyup", ".wc-pao-addon input, .wc-pao-addon textarea, .wc-pao-addon-custom-text", function() {
            var t = m(this);
            WC_PAO.Helper.delay(function() {
                s.validation.validateAddon(t, !0), s.updateTotals()
            }, 300)
        }), s.$el.on("change", "input.qty", function() {
            s.updateTotals()
        }), s.$el.on("touchstart", ".wc-pao-addon-image-swatch", function(t) {
            i = new Date
        }), s.$el.on("click touchend", ".wc-pao-addon-image-swatch", function(t) {
            if ((t.preventDefault(), "touchend" === t.type && i) && 100 < new Date - i) return;
            var t = m(this).data("value"),
                a = m(this).parents(".wc-pao-addon-wrap"),
                e = m.parseHTML(m(this).data("price")),
                o = a.find(".wc-pao-addon-image-swatch-selected-swatch");
            o.html(""), a.find(".wc-pao-addon-image-swatch").removeClass("selected"), m(this).addClass("selected"), a.find(".wc-pao-addon-image-swatch-select").val(t), o.html(e), s.validation.validateAddon(a.find("select.wc-pao-addon-field"), !0), s.updateTotals()
        }), s.$el.on("click", ".reset_variations", function() {
            s.totals.reset()
        }), s.$el.on("wc_variation_form", function() {
            s.validation.validate(), s.updateTotals()
        }), s.$el.on("found_variation", function(t, a) {
            s.totals.updateVariation(a), s.validation.validate(), s.updateTotals()
        }), s.$el.on("hide_variation", function(t) {
            s.updateTotals()
        }), s.$el.on("woocommerce-product-addons-update", function() {
            s.validation.validate(), s.updateTotals()
        }), s.$el.find(".datepicker").each(function() {
            var e = m(this),
                t = e.parent(),
                o = t.find(".reset_date"),
                i = t.find('input[name="' + e.attr("name") + '-wc-pao-date"]'),
                a = t.find('input[name="' + e.attr("name") + '-wc-pao-date-gmt-offset"]'),
                t = (a.length || ((a = m("<input/>")).attr("type", "hidden"), a.attr("name", e.attr("name") + "-wc-pao-date-gmt-offset"), t.append(a)), new Date),
                s = parseFloat(woocommerce_addons_params.gmt_offset, 10),
                n = t.getTimezoneOffset() / 60,
                a = ("default" === woocommerce_addons_params.date_input_timezone_reference ? a.val(n) : "store" === woocommerce_addons_params.date_input_timezone_reference && (t.getHours(), t.getMinutes(), a.val(s)), e.datepicker({
                    beforeShow: function(t, a) {
                        woocommerce_addons_params.datepicker_class && (m("#ui-datepicker-div").removeClass(woocommerce_addons_params.datepicker_class), m("#ui-datepicker-div").addClass(woocommerce_addons_params.datepicker_class))
                    },
                    dateFormat: woocommerce_addons_params.datepicker_date_format,
                    changeMonth: !0,
                    changeYear: !0,
                    yearRange: "c-100:c+10"
                }), e.datepicker("getDate"));
            null !== a && "function" == typeof a.getTime && (a.setHours(t.getHours(), t.getMinutes()), "store" === woocommerce_addons_params.date_input_timezone_reference && (a = WC_PAO.Helper.addMinutes(a, -1 * n * 60), a = WC_PAO.Helper.addMinutes(a, 60 * s)), i.val(a.getTime() / 1e3), o.show()), e.on("change", function() {
                var t, a = e.datepicker("getDate");
                null !== a && "function" == typeof a.getTime ? (t = new Date, a.setHours(t.getHours(), t.getMinutes()), "store" === woocommerce_addons_params.date_input_timezone_reference && (a = WC_PAO.Helper.addMinutes(a, -1 * n * 60), a = WC_PAO.Helper.addMinutes(a, 60 * s)), i.val(a.getTime() / 1e3), o.show()) : (o.hide(), i.val(""))
            }), o.on("click", function(t) {
                t.preventDefault(), i.val(""), e.val("").trigger("change")
            })
        }), m("#credit_called").on("keyup", function() {
            s.validation.validate(), s.updateTotals()
        })
    }, e.prototype.updateTotals = function() {
        this.totals.calculate(), (this.show_incomplete_subtotals || this.isValid()) && (this.contains_required || this.totals.$totals.data("price_data").length) ? this.totals.render() : this.totals.reset()
    }, e.prototype.isValid = function() {
        var t = !0;
        return this.$el.find("button.single_add_to_cart_button").is(".disabled") ? t = !1 : (m.each(this.validation.getValidationState(), function() {
            if (!this.validity) return t = !1
        }), t)
    }, e.prototype.containsRequired = function() {
        var a = !1;
        return this.$addons.each(function() {
            var t = m(this).data("restrictions");
            if (!m.isEmptyObject(t) && "required" in t && "yes" === t.required) return a = !0
        }), a
    }, e.prototype.is_in_viewport = function(t, a, e, o) {
        var i, s, n, r, d, c, p, l = m(_);
        if (!(t.length < 1)) return n = (t = 1 < t.length ? t.eq(0) : t).get(0), d = l.width(), p = l.height(), e = !0 !== e || n.offsetWidth * n.offsetHeight, o = o || "vertical", "function" == typeof n.getBoundingClientRect ? (c = 0 <= (n = n.getBoundingClientRect()).top && n.top < p, i = 0 < n.bottom && n.bottom <= p, r = n.top < 0 && n.bottom > p, s = 0 <= n.left && n.left < d, n = 0 < n.right && n.right <= d, r = a ? c || i || r : c && i, c = a ? s || n : s && n, "both" === o ? e && r && c : "vertical" === o ? e && r : "horizontal" === o ? e && c : void 0) : (s = (i = l.scrollTop()) + p, r = (n = l.scrollLeft()) + d, l = (p = (c = t.offset()).top) + t.height(), c = (d = c.left) + t.width(), t = !0 === a ? l : p, p = !0 === a ? p : l, l = !0 === a ? c : d, a = !0 === a ? d : c, "both" === o ? !!e && p <= s && i <= t && a <= r && n <= l : "vertical" === o ? !!e && p <= s && i <= t : "horizontal" === o ? !!e && a <= r && n <= l : void 0)
    }, o.prototype.showIncompleteSubtotals = function() {
        return 1 === this.$totals.data("show-incomplete-sub-total")
    }, o.prototype.updateVariation = function(t) {
        this.$variation_input = !!this.$form.hasClass("variations_form") && this.$form.find('input[name="variation_id"], input.variation_id'), this.product_id = t.variation_id, this.$totals.data("product-id", this.product_id), void 0 !== t.display_price ? this.base_price = t.display_price : m(t.price_html).find(".amount").last().length && (this.base_price = m(t.price_html).find(".amount").last().text(), this.base_price = this.base_price.replace(woocommerce_addons_params.currency_format_symbol, ""), this.base_price = this.base_price.replace(woocommerce_addons_params.currency_format_thousand_sep, ""), this.base_price = this.base_price.replace(woocommerce_addons_params.currency_format_decimal_sep, "."), this.base_price = this.base_price.replace(/[^0-9\.]/g, ""), this.base_price = parseFloat(this.base_price)), this.$totals.data("price", this.base_price)
    }, o.prototype.calculate = function() {
        var u = this;
        u.qty = parseFloat(u.$form.find("input.qty").val()), u.addons_price_data = [], u.total = 0, u.total_raw = 0, u.base_price = u.$totals.data("price"), u.raw_price = u.$totals.data("raw-price"), u.product_id = u.is_variable ? u.$variation_input.val() : u.$totals.data("product-id"), "" === u.base_price && "undefined" != typeof custom_gift_card_amount && custom_gift_card_amount.length && 0 < custom_gift_card_amount.val() && (u.base_price = custom_gift_card_amount.val()), woocommerce_addons_params.is_bookings && m(".wc-bookings-booking-cost").length && (u.base_price = parseFloat(m(".wc-bookings-booking-cost").attr("data-raw-price"))), this.$addons.each(function() {
            if (m(this).val()) {
                var t, a, e, o = m(this),
                    i = o.parents(".wc-pao-addon"),
                    s = i.find(".wc-pao-addon-name").length ? i.find(".wc-pao-addon-name").data("addon-name") : "",
                    n = "",
                    r = 0,
                    d = 0,
                    c = o.data("price-type"),
                    p = !1,
                    l = {},
                    _ = !!i.find(".wc-pao-addon-name").length && i.find(".wc-pao-addon-name").data("has-per-person-pricing"),
                    i = !!i.find(".wc-pao-addon-name").length && i.find(".wc-pao-addon-name").data("has-per-block-pricing");
                if (o.is(".wc-pao-addon-custom-price")) p = !0, r = o.val(), d = o.val(), c = "quantity_based";
                else if (o.is(".wc-pao-addon-input-multiplier")) "" !== o.val() && (o.val(Math.ceil(o.val())), r = o.data("price") * o.val(), d = o.data("raw-price") * o.val());
                else if (o.is(".wc-pao-addon-checkbox, .wc-pao-addon-radio")) {
                    if (!o.is(":checked")) return;
                    n = o.data("label"), r = o.data("price"), d = o.data("raw-price")
                } else if (o.is(".wc-pao-addon-image-swatch-select, .wc-pao-addon-select")) {
                    if (!o.find("option:selected") || "" === o.find("option:selected").val()) return;
                    c = o.find("option:selected").data("price-type"), n = o.find("option:selected").data("label"), r = o.find("option:selected").data("price"), d = o.find("option:selected").data("raw-price")
                } else {
                    if (!o.val()) return;
                    r = o.data("price"), d = o.data("raw-price")
                }
                switch (r = r || 0, d = d || 0, "booking" !== u.product_type && "accommodation-booking" !== u.product_type || !woocommerce_addons_params.is_bookings || (void(t = u.qty = 0) !== m("#wc_bookings_field_duration") && 0 < m("#wc_bookings_field_duration").val() && (t = m("#wc_bookings_field_duration").val()), void 0 !== m("#wc-bookings-form-end-time") && 0 < m("#wc-bookings-form-end-time").val() && (t = m("#wc-bookings-form-end-time").val()), e = m("#wc_bookings_field_persons"), a = 0, 1 === e.length ? a = parseInt(a, 10) + parseInt(e.val(), 10) : m(".wc-bookings-booking-form").find("input").each(function() {
                    var t = this.id.match(/wc_bookings_field_persons_(\d+)/);
                    null != t && m("#" + t[0]).length && (a = parseInt(a, 10) + parseInt(m("#" + t[0]).val(), 10))
                }), 0 === u.qty && m(".wc-bookings-booking-cost").length && (u.qty = 1), _ && a && (u.qty *= a), i && t && (u.qty *= t)), c) {
                    case "flat_fee":
                        l.cost = parseFloat(r), l.cost_raw = parseFloat(d);
                        break;
                    case "quantity_based":
                        l.cost_pu = parseFloat(r), l.cost_raw_pu = parseFloat(d), l.cost = l.cost_pu * u.qty, l.cost_raw = l.cost_raw_pu * u.qty;
                        break;
                    case "percentage_based":
                        l.cost_pct = parseFloat(r) / 100, l.cost_raw_pct = parseFloat(d) / 100, l.cost = parseFloat(u.base_price) * l.cost_pct * u.qty, l.cost_raw = parseFloat(u.raw_price) * l.cost_raw_pct * u.qty
                }
                u.total += l.cost || 0, u.total_raw += l.cost_raw || 0, void 0 !== n && ("number" == typeof n || n.length ? (l.name = s + (n ? " - " + n : ""), l.nameFormattedHTML = '<span class="wc-pao-addon-name">' + s + "</span>" + (n ? ' - <span class="wc-pao-addon-value">' + n + "</span>" : "")) : (e = o.val(), (_ = parseInt(woocommerce_addons_params.trim_user_input_characters, 10)) < (e = o.is(".wc-pao-addon-file-upload") ? e.replace(/^.*[\\\/]/, "") : e).length && (e = e.slice(0, _) + "..."), l.name = s + " - " + WC_PAO.Helper.escapeHtml(e), l.nameFormattedHTML = '<span class="wc-pao-addon-name">' + s + '</span> - <span class="wc-pao-addon-value">' + WC_PAO.Helper.escapeHtml(e) + "</span>"), l.is_custom_price = p, l.price_type = c, u.addons_price_data.push(l))
            }
        }), u.$totals.data("price_data", u.addons_price_data), u.$form.trigger("updated_addons")
    }, o.prototype.render = function() {
        var t, e, o, a, i, s, n, r, d, c = this;
        c.$totals.data("show-sub-total") && c.qty && (c.formatMoney(c.total), o = !1, void 0 !== c.base_price && c.product_id && (t = m(".wc-bookings-booking-form").length ? isNaN(c.base_price) ? 0 : parseFloat(c.base_price) : parseFloat(c.base_price * c.qty), e = c.formatMoney(t + c.total)), c.has_subscription_plans ? (a = c.$form.data("satt_script")) && a.schemes_model.get_active_scheme_key() && (a = c.$subscription_plans.find("input:checked")).val() && (i = a.parent().find(".subscription-details")) : c.$form.parent().find(".subscription-details").length && !c.$form.hasClass("bundle_data") && (i = c.$form.parent().find(".subscription-details"), c.$variation_input) && 0 < c.$variation_input.length && (i = c.$form.parent().find(".woocommerce-variation .subscription-details")), i && 0 < i.length && (s = " " + i.clone().wrap("<p>").parent().html()), "grouped" === c.product_type ? s && !WC_PAO.Helper.isGroupedMixedProductType() && WC_PAO.Helper.isGroupedSubsSelected() && e && (e += s) : s && e && (e += s), e) ? (a = c.$form.find(".wc-pao-addon-container").data("product-name"), i = c.formatMoney(t), s = c.$form.find(".wc-pao-addon-container").data("product-tax-status"), n = m(".wc-bookings-booking-form").length ? '<div class="product-addon-totals"><ul><li><div class="wc-pao-col1"><strong>' + a + '</strong></div><div class="wc-pao-col2"><strong><span class="amount">' + i + "</span></strong></div></li>" : '<div class="product-addon-totals"><ul><li><div class="wc-pao-col1"><strong><span>' + (c.is_rtl ? woocommerce_addons_params.quantity_symbol + c.qty : c.qty + woocommerce_addons_params.quantity_symbol) + "</span> " + a + '</strong></div><div class="wc-pao-col2"><strong><span class="amount">' + i + "</span></strong></div></li>", c.addons_price_data.length && m.each(c.addons_price_data, function(t, a) {
            var e = a.cost,
                e = 0 === e ? "-" : 0 < e ? c.formatMoney(e) : "-" + c.formatMoney(Math.abs(e));
            n = n + '<li><div class="wc-pao-col1"><strong>' + a.nameFormattedHTML + '</strong></div><div class="wc-pao-col2"><span class="amount">' + e + "</span></div></li>", woocommerce_addons_params.tax_enabled && a.is_custom_price && (o = !0)
        }), r = "", d = void 0 === c.$totals.data("i18n_sub_total") ? woocommerce_addons_params.i18n_sub_total : c.$totals.data("i18n_sub_total"), o || woocommerce_addons_params.price_display_suffix && woocommerce_addons_params.tax_enabled ? "taxable" !== s || o || !1 != -1 < woocommerce_addons_params.price_display_suffix.indexOf("{price_including_tax}") || !1 != -1 < woocommerce_addons_params.price_display_suffix.indexOf("{price_excluding_tax}") ? m.ajax({
            type: "POST",
            url: woocommerce_addons_params.ajax_url,
            data: {
                action: "wc_product_addons_calculate_tax",
                product_id: c.product_id,
                add_on_total: c.total,
                add_on_total_raw: c.total_raw,
                qty: c.qty
            },
            success: function(t) {
                var a;
                n = "SUCCESS" == t.result ? (r = '<small class="woocommerce-price-suffix">' + woocommerce_addons_params.price_display_suffix + "</small>", a = c.formatMoney(t.price_including_tax), t = c.formatMoney(t.price_excluding_tax), r = (r = r.replace("{price_including_tax}", '<span class="amount">' + a + "</span>")).replace("{price_excluding_tax}", '<span class="amount">' + t + "</span>"), a = woocommerce_addons_params.display_include_tax ? a : t, n + '<li class="wc-pao-subtotal-line"><p class="price">' + d + ' <span class="amount">' + a + "</span> " + r + " </p></li></ul></div>") : n + '<li class="wc-pao-subtotal-line"><p class="price">' + d + ' <span class="amount">' + e + "</span></p></li></ul></div>", c.show_subtotal_panel ? c.$totals.html(n) : c.$totals.html(""), c.$form.trigger("updated_addons")
            },
            error: function() {
                n = n + '<li class="wc-pao-subtotal-line"><p class="price">' + d + ' <span class="amount">' + e + "</span></p></li></ul></div>", c.show_subtotal_panel ? c.$totals.html(n) : c.$totals.html(""), c.$form.trigger("updated_addons")
            }
        }) : (n = n + '<li class="wc-pao-subtotal-line"><strong>' + d + ' <span class="amount">' + e + "</span> " + woocommerce_addons_params.price_display_suffix + "</strong></li></ul></div>", c.show_subtotal_panel ? c.$totals.html(n) : c.$totals.html(""), c.$form.trigger("updated_addons")) : (n = n + '<li class="wc-pao-subtotal-line"><p class="price">' + d + ' <span class="amount">' + e + "</span></p></li></ul></div>", c.show_subtotal_panel ? c.$totals.html(n) : c.$totals.html(""), c.$form.trigger("updated_addons"))) : (c.$totals.empty(), c.$form.trigger("updated_addons"))
    }, o.prototype.reset = function() {
        this.$totals.empty(), this.$totals.html(""), this.$form.trigger("updated_addons")
    }, o.prototype.formatMoney = function(t) {
        let a = woocommerce_addons_params.currency_format_num_decimals;
        var e;
        return woocommerce_addons_params.trim_trailing_zeros && (e = parseFloat(t) % 1 == 0, t = parseFloat(t), a = e ? 0 : t.toString().split(".")[1].length), accounting.formatMoney(t, {
            symbol: woocommerce_addons_params.currency_format_symbol,
            decimal: woocommerce_addons_params.currency_format_decimal_sep,
            thousand: woocommerce_addons_params.currency_format_thousand_sep,
            precision: a,
            format: woocommerce_addons_params.currency_format
        })
    }, e), m(function() {
        m("body").on("quick-view-displayed", function() {
            m(this).find(".cart:not(.cart_group)").each(function() {
                new WC_PAO.Form(m(this))
            })
        }), m("body").find(".cart:not(.cart_group)").each(function() {
            new WC_PAO.Form(m(this))
        })
    })
}(jQuery, window);